scale_y_log10(labels = scales::label_number_si()) +
labs(
title = "Salary by League Group (log scale)",
x = "League Group",
y = "Salary (€ – log scale)"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
ggplot(wages_cleaned, aes(x = leagues_Group, y = Salary)) +
geom_boxplot(outlier.alpha = 0.3) +
scale_y_log10(labels = scales::label_number()) +
labs(
title = "Salary by League Group (log scale)",
x = "League Group",
y = "Salary (€ – log scale)"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
ggplot(wages_cleaned, aes(x = leagues_group, y = Salary)) +
geom_boxplot(outlier.alpha = 0.3) +
scale_y_log10(labels = scales::label_number()) +
labs(
title = "Salary by League Group (log scale)",
x = "League Group",
y = "Salary (€ – log scale)"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
# I had 754 different leagues, so in order to correct this I scaled down to the most important ones and separate the rest as "others"
top_leagues <- c("Premier League", "LALIGA EA SPORTS", "Bundesliga",
"Serie A", "Ligue 1 Uber Eats", "Rosh Saudi League")
wages$leagues_group <- ifelse(wages$League %in% top_leagues,
wages$League,
"Other Leagues")
# datalocation <- file.path("C:","Users", "deirdre.lawless", "downloads") # in case you might want to run
# Folder Direction
datalocation <- file.path("/Users/ignacioalarconvarela/developer/CA-Statistics")
datapath <- file.path(datalocation, "raw_wages.csv")
wages <- read.csv("raw_wages.csv", header = TRUE)
colnames(wages) <- tolower(colnames(wages)) #Setting the column names to be in the Dataset
wages_cleaned <- readRDS("wages_cleaned.rds") #cleaned dataset to be able to render
dim(wages) #check dimmensions
sum(is.na(wages)) #check for missing values
head(wages, 2)
#| fig.cap: "Figure 1. Histograms for continuous variables showing the distribution of Age, Salary, Current Reputation, Total Apps, and National Caps. Red lines represent the normal density curve."
# Sample
set.seed(120)
wages_sample <- wages_cleaned[sample(nrow(wages_cleaned), 1000),] # Issues when rendering, solved by saving dataset after cleaning.
wages_sample$Salary_Millions <- wages_sample$Salary / 1e6 # Convert salary to millions
wages_sample$Reputation_Scaled <- wages_sample$`Current Reputation` / 1000
# 1. Age
hist_age <- ggplot(wages_sample, aes(x = Age)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$Age, na.rm = TRUE),
sd = sd(wages_sample$Age, na.rm = TRUE)),
colour = "red") +
labs(title = "Age", x = "Player Age", y = "Density")
# 2. Salary in Millions
hist_salary <- ggplot(wages_sample, aes(x = Salary_Millions)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$Salary_Millions, na.rm = TRUE),
sd = sd(wages_sample$Salary_Millions, na.rm = TRUE)),
colour = "red") +
labs(title = "Salary (€ Millions)", x = "Annual Salary (in Millions)", y = "Density")
# 3. Current Reputation
hist_cr <- ggplot(wages_sample, aes(x = `Current Reputation`)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$`Current Reputation`, na.rm = TRUE),
sd = sd(wages_sample$`Current Reputation`, na.rm = TRUE)),
colour = "red") +
scale_y_continuous(labels = scales::comma) + # Improved Visualization
labs(title = "Current Reputation", x = "Reputation Score", y = "Density")
# 4. Total Apps
hist_apps <- ggplot(wages_sample, aes(x = `Total Apps`)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$`Total Apps`, na.rm = TRUE),
sd = sd(wages_sample$`Total Apps`, na.rm = TRUE)),
colour = "red") +
labs(title = "Total Apps", x = "Total Club Appearances", y = "Density")
# 5. National Caps
hist_caps <- ggplot(wages_sample, aes(x = `National Caps`)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$`National Caps`, na.rm = TRUE),
sd = sd(wages_sample$`National Caps`, na.rm = TRUE)),
colour = "red") +
labs(title = "National Caps", x = "National Appearances", y = "Density")
# Combine in grid
grid.arrange(hist_age, hist_salary, hist_cr, hist_apps, hist_caps, ncol = 3)
#| fig.cap: "Figure 2. Q–Q plots for continuous variables assessing deviations from normality. Points deviating substantially from the red line indicate not normal distributions."
par(mfrow = c(2, 3))
qqnorm(wages_sample$Age, main = "Q-Q Plot: Age"); qqline(wages_sample$Age, col = 2)
qqnorm(wages_sample$Salary_Millions, main = "Q-Q Plot: Salary (€M)"); qqline(wages_sample$Salary_Millions, col = 2)
qqnorm(wages_sample$`Current Reputation`, main = "Q-Q Plot: Current Reputation"); qqline(wages_sample$`Current Reputation`, col = 2)
qqnorm(wages_sample$`Total Apps`, main = "Q-Q Plot: Total Apps"); qqline(wages_sample$`Total Apps`, col = 2)
qqnorm(wages_sample$`National Caps`, main = "Q-Q Plot: National Caps"); qqline(wages_sample$`National Caps`, col = 2)
par(mfrow = c(1,1))  # reset layout
# Dropping columns that are not useful
wages <- wages |>
select(  -name, -club, -position, -based, -begins, -expires, -last.club, -last.trans..fee
)
# Check remaining variables
colnames(wages)
# Correcting invisible blanks and dashes
wages <- wages %>%
mutate(across(where(is.character), ~ {
x <- gsub("\u00A0", " ", .)
x <- trimws(x)
x[x %in% c("", "-", "--", "- -")] <- NA
x
}))
# Re-check missing values
colSums(is.na(wages))
# Dropping columns that are not useful
wages <- wages |>
select(  -name, -club, -position, -based, -begins, -expires, -last.club, -last.trans..fee
)
# Renaming columns for clarity
wages <- wages |>
dplyr::rename(
League            = division,
Nationality       = nat,
`EU Player`       = eu.national,
`National Caps`   = caps,
`Total Apps`      = `at.apps`,
Age               = age,
`Current Reputation` = cr,
Salary            = salary
)
colnames(wages)
#removing the rows of our valid columns, since wouldn't contribute to the analyses
wages <- na.omit(wages)
colSums(is.na(wages))
# I had 754 different leagues, so in order to correct this I scaled down to the most important ones and separate the rest as "others"
top_leagues <- c("Premier League", "LALIGA EA SPORTS", "Bundesliga",
"Serie A", "Ligue 1 Uber Eats", "Rosh Saudi League")
wages$leagues_group <- ifelse(wages$League %in% top_leagues,
wages$League,
"Other Leagues")
# Removing extra symbols and spaces, and ensuring data behaves as intended by converting variables to factors
#wages$League <- as.factor(wages$League)
wages$LeagueGroup <- as.factor(str_trim(wages$LeagueGroup))
# I had 754 different leagues, so in order to correct this I scaled down to the most important ones and separate the rest as "others"
top_leagues <- c("Premier League", "LALIGA EA SPORTS", "Bundesliga",
"Serie A", "Ligue 1 Uber Eats", "Rosh Saudi League")
# Recode leagues into groups
wages$LeagueGroup <- ifelse(wages$League %in% top_leagues,
wages$League,
"Other Leagues")
# Removing extra symbols and spaces, and ensuring data behaves as intended by converting variables to factors
wages$League <- as.factor(str_trim(wages$League))
wages$LeagueGroup <- as.factor(str_trim(wages$LeagueGroup))
wages$Nationality <- as.factor(wages$Nationality)
wages$`EU Player` <- factor(str_trim(wages$`EU Player`), levels = c("No", "Yes")) # Convert to binary
wages$`National Caps` <- as.numeric(wages$`National Caps`) # Convert National Cap  to numeric
wages$`Total Apps` <- as.numeric(str_replace_all(wages$`Total Apps`, "[^0-9]", "")) # Clean and convert total apps to numeric
wages$`Current Reputation` <- as.numeric(str_replace_all(wages$`Current Reputation`, ",", "")) # Clean and convert Current reputation to numeric
wages$Salary <- as.numeric(str_replace_all(wages$Salary, "[^0-9]", ""))# Clean and convert salary to numeric
# Strucure and summary
str(wages)
# Save cleaned dataset
saveRDS(wages, "wages_cleaned.rds")
wages_cleaned <- readRDS("wages_cleaned.rds")
head(wages_cleaned, 2)
rm(list=ls())
# Loading all libraries
quiet_library <- function(pkg) {
suppressMessages(suppressWarnings({
if (!requireNamespace(pkg, quietly = TRUE)) {
install.packages(pkg, quiet = TRUE)
}
library(pkg, character.only = TRUE)
}))
}
quiet_library("tidyverse")
# Collection of R packages (dplyr, ggplot2, tidyr, etc.) for data wrangling, visualization, and analysis
quiet_library("pastecs")
# Tools for descriptive statistics, time series analysis, and data exploration (e.g., stat.desc)
quiet_library("psych")   # Descriptive statistics by group
quiet_library("FSA")
# Includes general tools for data analysis (e.g., nonparametric tests, bootstrapping)
quiet_library("semTools")
# Supplementary functions for Structural Equation Modeling (SEM), including model fit, reliability, and measurement invariance tests
quiet_library("VIM") # Visualization and Imputation of Missing Values
quiet_library("naniar") #(naniar short for NA + naniar) - Missing data wrangling plus Little's test
quiet_library("simputation") # For imputing variables
quiet_library("sjstats")  # Provides convenient functions for effect sizes
quiet_library("gmodels")  # Includes 'CrossTable()' for contingency tables.
quiet_library("car")   # Includes Levene's test for homogeneity
quiet_library("effectsize")  # Effect size calculations (Cohen’s d, η², Cramer’s V, etc.)
quiet_library("rstatix")     # Easy-to-use t-tests, ANOVA, nonparametric tests, post-hoc, etc.
quiet_library("gridExtra") # To arrange visualizations.
quiet_library("gtsummary") # Formatting tables
quiet_library("flextable") # Formatting tables
# datalocation <- file.path("C:","Users", "deirdre.lawless", "downloads") # in case you might want to run
# Folder Direction
datalocation <- file.path("/Users/ignacioalarconvarela/developer/CA-Statistics")
datapath <- file.path(datalocation, "raw_wages.csv")
wages <- read.csv("raw_wages.csv", header = TRUE)
colnames(wages) <- tolower(colnames(wages)) #Setting the column names to be in the Dataset
wages_cleaned <- readRDS("wages_cleaned.rds") #cleaned dataset to be able to render
dim(wages) #check dimmensions
sum(is.na(wages)) #check for missing values
head(wages, 2)
# Correcting invisible blanks and dashes
wages <- wages %>%
mutate(across(where(is.character), ~ {
x <- gsub("\u00A0", " ", .)
x <- trimws(x)
x[x %in% c("", "-", "--", "- -")] <- NA
x
}))
# Re-check missing values
colSums(is.na(wages))
# Dropping columns that are not useful
wages <- wages |>
select(  -name, -club, -position, -based, -begins, -expires, -last.club, -last.trans..fee
)
# Check remaining variables
colnames(wages)
# Renaming columns for clarity
wages <- wages |>
dplyr::rename(
League            = division,
Nationality       = nat,
`EU Player`       = eu.national,
`National Caps`   = caps,
`Total Apps`      = `at.apps`,
Age               = age,
`Current Reputation` = cr,
Salary            = salary
)
colnames(wages)
#removing the rows of our valid columns, since wouldn't contribute to the analyses
wages <- na.omit(wages)
colSums(is.na(wages))
# I had 754 different leagues, so in order to correct this I scaled down to the most important ones and separate the rest as "others"
top_leagues <- c("Premier League", "LALIGA EA SPORTS", "Bundesliga",
"Serie A", "Ligue 1 Uber Eats", "Rosh Saudi League")
# Recode leagues into groups
wages$LeagueGroup <- ifelse(wages$League %in% top_leagues,
wages$League,
"Other Leagues")
# Removing extra symbols and spaces, and ensuring data behaves as intended by converting variables to factors
wages$LeagueGroup <- as.factor(str_trim(wages$LeagueGroup))
wages$Nationality <- as.factor(wages$Nationality)
wages$`EU Player` <- factor(str_trim(wages$`EU Player`), levels = c("No", "Yes")) # Convert to binary
wages$`National Caps` <- as.numeric(wages$`National Caps`) # Convert National Cap  to numeric
wages$`Total Apps` <- as.numeric(str_replace_all(wages$`Total Apps`, "[^0-9]", "")) # Clean and convert total apps to numeric
wages$`Current Reputation` <- as.numeric(str_replace_all(wages$`Current Reputation`, ",", "")) # Clean and convert Current reputation to numeric
wages$Salary <- as.numeric(str_replace_all(wages$Salary, "[^0-9]", ""))# Clean and convert salary to numeric
# Strucure and summary
str(wages)
# I had 754 different leagues, so in order to correct this I scaled down to the most important ones and separate the rest as "others"
top_leagues <- c("Premier League", "LALIGA EA SPORTS", "Bundesliga",
"Serie A", "Ligue 1 Uber Eats", "Rosh Saudi League")
# Recode leagues into groups
wages$League <- ifelse(wages$League %in% top_leagues,
wages$League,
"Other Leagues")
# Removing extra symbols and spaces, and ensuring data behaves as intended by converting variables to factors
wages$League <- as.factor(str_trim(wages$League))
wages$Nationality <- as.factor(wages$Nationality)
wages$`EU Player` <- factor(str_trim(wages$`EU Player`), levels = c("No", "Yes")) # Convert to binary
wages$`National Caps` <- as.numeric(wages$`National Caps`) # Convert National Cap  to numeric
wages$`Total Apps` <- as.numeric(str_replace_all(wages$`Total Apps`, "[^0-9]", "")) # Clean and convert total apps to numeric
wages$`Current Reputation` <- as.numeric(str_replace_all(wages$`Current Reputation`, ",", "")) # Clean and convert Current reputation to numeric
wages$Salary <- as.numeric(str_replace_all(wages$Salary, "[^0-9]", ""))# Clean and convert salary to numeric
# Strucure and summary
str(wages)
# Save cleaned dataset
saveRDS(wages, "wages_cleaned.rds")
wages_cleaned <- readRDS("wages_cleaned.rds")
head(wages_cleaned, 2)
# Showing mean, sd, skew, and kurtosis per variable
# Age
print("AGE")
print(summary(wages_sample$Age))
#| fig.cap: "Figure 1. Histograms for continuous variables showing the distribution of Age, Salary, Current Reputation, Total Apps, and National Caps. Red lines represent the normal density curve."
# Sample
set.seed(120)
wages_sample <- wages_cleaned[sample(nrow(wages_cleaned), 1000),] # Issues when rendering, solved by saving dataset after cleaning.
wages_sample$Salary_Millions <- wages_sample$Salary / 1e6 # Convert salary to millions
wages_sample$Reputation_Scaled <- wages_sample$`Current Reputation` / 1000
# 1. Age
hist_age <- ggplot(wages_sample, aes(x = Age)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$Age, na.rm = TRUE),
sd = sd(wages_sample$Age, na.rm = TRUE)),
colour = "red") +
labs(title = "Age", x = "Player Age", y = "Density")
# 2. Salary in Millions
hist_salary <- ggplot(wages_sample, aes(x = Salary_Millions)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$Salary_Millions, na.rm = TRUE),
sd = sd(wages_sample$Salary_Millions, na.rm = TRUE)),
colour = "red") +
labs(title = "Salary (€ Millions)", x = "Annual Salary (in Millions)", y = "Density")
# 3. Current Reputation
hist_cr <- ggplot(wages_sample, aes(x = `Current Reputation`)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$`Current Reputation`, na.rm = TRUE),
sd = sd(wages_sample$`Current Reputation`, na.rm = TRUE)),
colour = "red") +
scale_y_continuous(labels = scales::comma) + # Improved Visualization
labs(title = "Current Reputation", x = "Reputation Score", y = "Density")
# 4. Total Apps
hist_apps <- ggplot(wages_sample, aes(x = `Total Apps`)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$`Total Apps`, na.rm = TRUE),
sd = sd(wages_sample$`Total Apps`, na.rm = TRUE)),
colour = "red") +
labs(title = "Total Apps", x = "Total Club Appearances", y = "Density")
# 5. National Caps
hist_caps <- ggplot(wages_sample, aes(x = `National Caps`)) +
geom_histogram(aes(y = after_stat(density)), fill = "grey", colour = "black", bins = 30) +
stat_function(fun = dnorm,
args = list(mean = mean(wages_sample$`National Caps`, na.rm = TRUE),
sd = sd(wages_sample$`National Caps`, na.rm = TRUE)),
colour = "red") +
labs(title = "National Caps", x = "National Appearances", y = "Density")
# Combine in grid
grid.arrange(hist_age, hist_salary, hist_cr, hist_apps, hist_caps, ncol = 3)
#| fig.cap: "Figure 2. Q–Q plots for continuous variables assessing deviations from normality. Points deviating substantially from the red line indicate not normal distributions."
par(mfrow = c(2, 3))
qqnorm(wages_sample$Age, main = "Q-Q Plot: Age"); qqline(wages_sample$Age, col = 2)
qqnorm(wages_sample$Salary_Millions, main = "Q-Q Plot: Salary (€M)"); qqline(wages_sample$Salary_Millions, col = 2)
qqnorm(wages_sample$`Current Reputation`, main = "Q-Q Plot: Current Reputation"); qqline(wages_sample$`Current Reputation`, col = 2)
qqnorm(wages_sample$`Total Apps`, main = "Q-Q Plot: Total Apps"); qqline(wages_sample$`Total Apps`, col = 2)
qqnorm(wages_sample$`National Caps`, main = "Q-Q Plot: National Caps"); qqline(wages_sample$`National Caps`, col = 2)
par(mfrow = c(1,1))  # reset layout
# Showing mean, sd, skew, and kurtosis per variable
# Age
print("AGE")
print(summary(wages_sample$Age))
print(paste("SD:", round(sd(wages_sample$Age, na.rm = TRUE), 2)))
print(semTools::skew(wages_sample$Age))
print(semTools::kurtosis(wages_sample$Age))
# Salary already in Millions
print("SALARY")
print(summary(wages_sample$Salary_Millions))
print(paste("SD:", round(sd(wages_sample$Salary_Millions, na.rm = TRUE), 2)))
print(semTools::skew(wages_sample$Salary_Millions))
print(semTools::kurtosis(wages_sample$Salary_Millions))
# Current Reputation
print("CURRENT REPUTATION")
print(summary(wages_sample$`Current Reputation`))
print(paste("SD:", round(sd(wages_sample$`Current Reputation`, na.rm = TRUE), 2)))
print(semTools::skew(wages_sample$`Current Reputation`))
print(semTools::kurtosis(wages_sample$`Current Reputation`))
# Total Apps
print("TOTAL APPS")
print(summary(wages_sample$`Total Apps`))
print(paste("SD:", round(sd(wages_sample$`Total Apps`, na.rm = TRUE), 2)))
print(semTools::skew(wages_sample$`Total Apps`))
print(semTools::kurtosis(wages_sample$`Total Apps`))
# National Caps
print("NATIONAL CAPS")
print(summary(wages_sample$`National Caps`))
print(paste("SD:", round(sd(wages_sample$`National Caps`, na.rm = TRUE), 2)))
print(semTools::skew(wages_sample$`National Caps`))
print(semTools::kurtosis(wages_sample$`National Caps`))
cor_test <- cor.test( wages_cleaned$Salary, wages_cleaned$`Current Reputation`, method = "spearman", exact = FALSE
)
cor_test
# Mann–Whitney U test: comparing salaries between EU and Non-EU players
mw_test <- wilcox.test(Salary ~ `EU Player`, data = wages_cleaned, exact = FALSE)
mw_test
# Extract key values for report
W <- mw_test$statistic
pval <- format.pval(mw_test$p.value, digits = 3)
cat("W =", W, ", p-value =", pval)
# Check distribution
table(wages_cleaned$Leagues)
# Run Kruskal–Wallis again
kruskal_test <- kruskal.test(Salary ~ Leagues, data = wages_cleaned)
# Check distribution
table(wages_cleaned$League)
# Run Kruskal–Wallis again
kruskal_test <- kruskal.test(Salary ~ League, data = wages_cleaned)
kruskal_test
ggplot(wages_cleaned, aes(x = League, y = Salary)) +
geom_boxplot(outlier.alpha = 0.3) +
scale_y_log10(labels = scales::label_number()) +
labs(
title = "Salary by League Group (log scale)",
x = "League Group",
y = "Salary (€ – log scale)"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
# Check distribution
table(wages_cleaned$League)
# Run Kruskal–Wallis again
kruskal_test <- kruskal.test(Salary ~ League, data = wages_cleaned)
kruskal_test
# Contingency table
tab_league_eu <- table(wages$`EU Player`, wages$League)
# Chi-square test of independence
chi_res <- chisq.test(tab_league_eu)
# Effect size: Cramer's V
N <- sum(tab_league_eu)
r <- nrow(tab_league_eu); c <- ncol(tab_league_eu)
cramers_v <- sqrt(as.numeric(chi_res$statistic) / (N * (min(r - 1, c - 1))))
# Helpful diagnostics / interpretation aids
exp_counts <- chi_res$expected                   # check all >= 5
share_within_league <- prop.table(tab_league_eu, margin = 2)  # EU % per league
list(stat = chi_res$statistic,
df = chi_res$parameter,
p = chi_res$p.value,
V = cramers_v)
wages_c <- wages %>%
filter(!is.na(`EU Player`) & !is.na(League))
# Chi-square cross-tabulation in SPSS-style format
gmodels::CrossTable(
wages_c$`EU Player`,
wages_c$League,
fisher = TRUE,
chisq = TRUE,
expected = TRUE,
sresid = TRUE,
format = "SPSS"
)
library(gmodels)
library(dplyr)
# Remove rows with missing values just in case
wages_c <- wages %>%
filter(!is.na(`EU Player`) & !is.na(League))
# Run SPSS-style Chi-square CrossTable
gmodels::CrossTable(
wages_c$`EU Player`,
wages_c$League,
chisq = TRUE,        # Chi-square test only
expected = TRUE,     # Show expected values
sresid = TRUE,       # Show standardized residuals
format = "SPSS"      # SPSS-style output
)
# Remove rows with missing values just in case
wages_c <- wages %>%
filter(!is.na(`EU Player`) & !is.na(League))
# Run SPSS-style Chi-square CrossTable
gmodels::CrossTable(
wages_c$League,
wages_c$`EU Player`,
chisq = TRUE,        # Chi-square test only
expected = TRUE,     # Show expected values
sresid = TRUE,       # Show standardized residuals
format = "SPSS"      # SPSS-style output
)
#| label: Box-Plot - Player salaries by football league
#| fig.cap: "Boxplot of player salaries by football league"
# The log transformation was applied to improve visualization due to the highly skewed salary distribution.
ggplot(wages_cleaned, aes(x = League, y = Salary)) +
geom_boxplot(outlier.alpha = 0.3) +
scale_y_log10(labels = scales::label_number()) +
labs(
title = "Salary by League Group",
x = "League Group",
y = "Salary €"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
# Loading all libraries
quiet_library <- function(pkg) {
suppressMessages(suppressWarnings({
if (!requireNamespace(pkg, quietly = TRUE)) {
install.packages(pkg, quiet = TRUE)
}
library(pkg, character.only = TRUE)
}))
}
quiet_library("tidyverse")
# Collection of R packages (dplyr, ggplot2, tidyr, etc.) for data wrangling, visualization, and analysis
quiet_library("pastecs")
# Tools for descriptive statistics, time series analysis, and data exploration (e.g., stat.desc)
quiet_library("psych")   # Descriptive statistics by group
quiet_library("FSA")
# Includes general tools for data analysis (e.g., nonparametric tests, bootstrapping)
quiet_library("semTools")
# Supplementary functions for Structural Equation Modeling (SEM), including model fit, reliability, and measurement invariance tests
quiet_library("VIM") # Visualization and Imputation of Missing Values
quiet_library("naniar") #(naniar short for NA + naniar) - Missing data wrangling plus Little's test
quiet_library("simputation") # For imputing variables
quiet_library("sjstats")  # Provides convenient functions for effect sizes
quiet_library("gmodels")  # Includes 'CrossTable()' for contingency tables.
quiet_library("car")   # Includes Levene's test for homogeneity
quiet_library("effectsize")  # Effect size calculations (Cohen’s d, η², Cramer’s V, etc.)
quiet_library("rstatix")     # Easy-to-use t-tests, ANOVA, nonparametric tests, post-hoc, etc.
quiet_library("gridExtra") # To arrange visualizations.
quiet_library("gtsummary") # Formatting tables
quiet_library("flextable") # Formatting tables
quiet_library("DT") #For cleaner output instead of head(dataset)
#head(wages, 1)
datatable(head(wages, 5))
#head(wages, 1)
library(knitr)
kable(head(wages, 1))
#head(wages, 1)
library(tibble)
as_tibble(head(wages, 1))
#head(wages, 1)
datatable(head(wages, 5))
#head(wages, 1)
datatable(head(wages, 3))
